<!DOCTYPE html>
<html>
<head>
  <title>Dashboard - CodeVault</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    CodeVault
    <button class="logout" onclick="logout()">Logout</button>
  </header>

  <button class="btn" style="margin: 1rem;" onclick="window.location.href='newfile.html'">+ New File</button>

  <div class="file-list" id="file-list"></div>

<script>
async function loadFiles() {
  const res = await fetch('/api/files');
  if (res.ok) {
    const files = await res.json();
    document.getElementById('file-list').innerHTML = files.map(file => `
      <div class="file-card" onclick="viewFile('${file._id}')">
        <div class="filename">${file.filename}</div>
        <div class="date">${new Date(file.createdAt).toLocaleString()}</div>
      </div>
    `).join('');
  } else {
    window.location.href = 'index.html';
  }
}

function viewFile(id) {
  window.location.href = 'viewfile.html?id=' + id;
}

async function logout() {
  await fetch('/api/logout');
  window.location.href = 'index.html';
}

loadFiles();
</script>
</body>
</html>
